<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>New Tab</title>

<button onclick="openBlobUrl()">Button</button>
<style>
  :root{
    --bg:#f7f9fc;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#007bff;
    --shadow: 0 8px 30px rgba(15,23,42,0.12);
    --radius:14px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    background:var(--bg);
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px;
    color:#111827;
  }

  button{
    background:#ADD8E6;
    border-radius:12px;
    padding:22px 64px;
    font-weight:700;
    font-size:20px;
    color:#000000;
    border:none;
    box-shadow:0 8px 24px rgba(15,23,42,0.12);
    cursor:pointer;
    transition: transform .18s ease, box-shadow .18s;
  }
  button:hover{ transform:translateY(-4px); box-shadow:0 14px 36px rgba(15,23,42,0.14) }
  button:active{ transform:translateY(0) }
</style>
</head>
<body>

<script>
/* Open blob tab with selected title + favicon; revoke URL quickly */
function openBlobUrl(){
  const favicon = localStorage.getItem(KEY_FAV) || options[selectedIndex].src;
  const title = localStorage.getItem(KEY_TITLE) || options[selectedIndex].title || "New Tab";
  const linkTag = favicon ? `<link rel="icon" href="${favicon}">` : "";

  const content = `<!doctype html>
  <html>
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>${escapeHtml(title)}</title>
      ${linkTag}
      <style>
        html,body,iframe{margin:0;padding:0;border:0;height:100%;width:100%}
        iframe{display:block;height:100vh;width:100vw}
      </style>
    </head>
    <body>
      <iframe src="https://frostchicken.vercel.app" allowfullscreen></iframe>
    </body>
  </html>`;

  const blob = new Blob([content], {type: "text/html"});
  const blobUrl = URL.createObjectURL(blob);
  const w = window.open(blobUrl, "_blank");

  setTimeout(()=> URL.revokeObjectURL(blobUrl), 800);
  if(w) w.focus();
}

/* small HTML escape for title insertion */
function escapeHtml(str){
  return String(str).replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[s]));
}
openBtn.addEventListener("click", openBlobUrl);
</script>
</body>
</html>

<script>
  const encoded = btoa(html);
  alert(encoded);
</script>